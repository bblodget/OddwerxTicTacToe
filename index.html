<html>

<head>
	<title>Oddwerx Tick-Tack-Toe</title>
	<link rel="stylesheet" href="main.css" type="text/css">
</head>

<body>


<span id="game">
<h1 id="turn">X's Turn</h1>

<a id="tl" href="#tl" class="button">&nbsp;</a>
<a id="tc" href="#tc" class="button">&nbsp;</a>
<a id="tr" href="#tr" class="button">&nbsp;</a>
<br/>
<a id="ml" href="#ml" class="button">&nbsp;</a>
<a id="mc" href="#mc" class="button">&nbsp;</a>
<a id="mr" href="#mr" class="button">&nbsp;</a>
<br/>
<a id="bl" href="#bl" class="button">&nbsp;</a>
<a id="bc" href="#bc" class="button">&nbsp;</a>
<a id="br" href="#br" class="button">&nbsp;</a>

<p/>

<button id="new_game" type="button">New Game</button>
<button id="get_json" type="button">Get Json</button>
<button id="post_json" type="button">Post Json</button>

<div id="result">

</div>

</span>


<span id="logo">
<img src="OddwerxTicTacToe.jpg">
</span>

</body>


<script type="text/javascript" src="jquery-1.5.2.min.js"></script>


<script type="text/javascript">
jQuery(function() {

	var cloud_data;

	var timer_id;		// id of the running timer.

	// Which player moved X or O
	var player_field1="X";  

	// location of move (0..8)
	// 0 1 2
	// 3 4 5
	// 6 7 8
	var movepos_field2=0;	

	// The game board rows
	// X or O or E (Empty)
	var toprow_field3="EEE";
	var midrow_field4="EEE";
	var botrow_field5="EEE";

	// The command string
	// "new_game"
	// "place" : move specified piece to location

	function newGame() {
		$('#tl').html("&nbsp;");
		$('#tc').html("&nbsp;");
		$('#tr').html("&nbsp;");

		$('#ml').html("&nbsp;");
		$('#mc').html("&nbsp;");
		$('#mr').html("&nbsp;");

		$('#bl').html("&nbsp;");
		$('#bc').html("&nbsp;");
		$('#br').html("&nbsp;");

		player_field1="X"
		$('#turn').text(player_field1+"'s Turn");
	}

	$('a').click(
		function(event) {
			$(this).text(player_field1);
			if (player_field1=="X") {
				player_field1="O";
			} else {
				player_field1="X";
			}
			$('#turn').text(player_field1+"'s Turn");
		}
	);

	$('#new_game').click(
		function(event) {
			newGame();
		}
	);

	$('#get_json').click(
		function(event) {
			var
			url="http://bots.myrobots.com/channels/575/feed.json?key=AEB7363505F543FC&callback=?"
			$.getJSON(url,
				function(data) {
					cloud_data = data
					var feeds = data.feeds
					var last = feeds[feeds.length-1]
					//alert("field1: "+last.field1);
					$('#result').html("Get: "+last.field1);	
					field1 = parseFloat(last.field1)
				}
			);
		}
	);

	$('#post_json').click(
		function(event) {
			cloud_data.channel.field1=player_field1;
			url="http://bots.myrobots.com/update"
			$('#result').html("Post: "+player_field1);	

			/*
			$.post(url, 
				{'key':'AEB7363505F543FC', 'field1':field1} ,
				function(data) {
					alert("posted: "+data);
				}, 
				'jsonp'
			);
			*/

			$.ajax({
            	'type' : 'POST',
           		'url' : url,
            	'data' : {'key':'AEB7363505F543FC', 
							'field1':player_field1
						},
            	'complete' : function(jqXHR, textStatus) {
					//alert("complete: "+textStatus);
            	},        
           	 	'dataType' : 'jsonp',
        	});
			
		}
	);

	/* Startup code */
	newGame();


});
</script>

</html>
